<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Query data | Vuex Easy Firestore 🔥</title>
    <meta name="description" content="Easy coupling of firestore and vuex. 2-way sync with 0 boilerplate!">
    
    
    <link rel="preload" href="/vuex-easy-firestore/assets/css/styles.b09044e6.css" as="style"><link rel="preload" href="/vuex-easy-firestore/assets/js/app.b09044e6.js" as="script"><link rel="preload" href="/vuex-easy-firestore/assets/js/10.5094f20e.js" as="script"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/4.6f83facc.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/css/1.styles.d3602896.css"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/1.d3602896.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/css/2.styles.8662775e.css"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/2.8662775e.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/3.25383995.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/5.799ee39a.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/6.603af246.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/7.aaf5a995.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/8.a9ae9742.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/9.1e962ae4.js"><link rel="prefetch" href="/vuex-easy-firestore/assets/js/11.78e53883.js">
    <link rel="stylesheet" href="/vuex-easy-firestore/assets/css/1.styles.d3602896.css"><link rel="stylesheet" href="/vuex-easy-firestore/assets/css/2.styles.8662775e.css"><link rel="stylesheet" href="/vuex-easy-firestore/assets/css/styles.b09044e6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuex-easy-firestore/" class="home-link router-link-active"><!----> <span class="site-name">Vuex Easy Firestore 🔥</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/mesqueeb/vuex-easy-firestore/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/mesqueeb/vuex-easy-firestore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/mesqueeb/vuex-easy-firestore/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/mesqueeb/vuex-easy-firestore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/vuex-easy-firestore/setup.html" class="sidebar-link">Installation &amp; setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/setup.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/setup.html#setup" class="sidebar-link">Setup</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/setup.html#first-steps" class="sidebar-link">First steps</a></li></ul></li><li><a href="/vuex-easy-firestore/add-and-manage-data.html" class="sidebar-link">Add and manage data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#basic-usage" class="sidebar-link">Basic usage</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#collection-mode" class="sidebar-link">'collection' mode</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#doc-mode" class="sidebar-link">'doc' mode</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#batch-updates-inserts-deletions" class="sidebar-link">Batch updates/inserts/deletions</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/add-and-manage-data.html#duplicating-docs" class="sidebar-link">Duplicating docs</a></li></ul></li><li><a href="/vuex-easy-firestore/query-data.html" class="active sidebar-link">Query data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#get-data" class="sidebar-link">Get data</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#realtime-updates-vs-single-fetch" class="sidebar-link">Realtime updates vs single fetch</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#realtime-updates-opendbchannel" class="sidebar-link">Realtime updates: openDBChannel</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#fetching-docs" class="sidebar-link">Fetching docs</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#firestore-authentication" class="sidebar-link">Firestore authentication</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#where-orderby-filters" class="sidebar-link">where / orderBy filters</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#multiple-modules-with-2-way-sync" class="sidebar-link">Multiple modules with 2-way sync</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#sync-directly-to-module-state" class="sidebar-link">Sync directly to module state</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/query-data.html#manual-fetch-handling" class="sidebar-link">Manual fetch handling</a></li></ul></li><li><a href="/vuex-easy-firestore/firestore-fields-and-functions.html" class="sidebar-link">Firestore fields and functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/firestore-fields-and-functions.html#arrayunion-and-arrayremove" class="sidebar-link">arrayUnion and arrayRemove</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/firestore-fields-and-functions.html#delete-fields" class="sidebar-link">Delete fields</a></li></ul></li><li><a href="/vuex-easy-firestore/hooks.html" class="sidebar-link">Hooks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#hooks-on-local-changes" class="sidebar-link">Hooks on local changes</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#hooks-after-server-changes" class="sidebar-link">Hooks after server changes</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/hooks.html#execution-timings-of-hooks" class="sidebar-link">Execution timings of hooks</a></li></ul></li><li><a href="/vuex-easy-firestore/extra-features.html" class="sidebar-link">Extra features</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#variables-for-firestorepath-or-filters" class="sidebar-link">Variables for firestorePath or filters</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#fillables-and-guard" class="sidebar-link">Fillables and guard</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#default-values" class="sidebar-link">Default values</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#firestore-timestamp-conversion" class="sidebar-link">Firestore Timestamp conversion</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#shortcut-set-path-doc" class="sidebar-link">Shortcut: set(path, doc)</a></li><li class="sidebar-sub-header"><a href="/vuex-easy-firestore/extra-features.html#pass-firebase-dependency" class="sidebar-link">Pass Firebase dependency</a></li></ul></li><li><a href="/vuex-easy-firestore/config-example.html" class="sidebar-link">Config example</a></li><li><a href="/vuex-easy-firestore/feedback.html" class="sidebar-link">Feedback</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="query-data"><a href="#query-data" aria-hidden="true" class="header-anchor">#</a> Query data</h1> <h2 id="get-data"><a href="#get-data" aria-hidden="true" class="header-anchor">#</a> Get data</h2> <p>The prime philosophy of Vuex Easy Firestore is to be able to have a vuex module (or several) which are all in sync with Firestore. When your app is openend there are two ways you can get data from Firestore and have it added to your vuex modules:</p> <ul><li>get realtime updates</li> <li>fetch the document(s) once</li></ul> <p>To have a better understanding of the difference I will give some examples:</p> <h2 id="realtime-updates-vs-single-fetch"><a href="#realtime-updates-vs-single-fetch" aria-hidden="true" class="header-anchor">#</a> Realtime updates vs single fetch</h2> <p>Realtime updates are powered by Firestore's <a href="https://firebase.google.com/docs/firestore/query-data/listen" target="_blank" rel="noopener noreferrer">onSnapshot<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> listener. This means that if data on the server is changed, the changes are pushed to all clients that have your application open.</p> <p>With Vuex easy firestore using <em>realtime updates</em> will effectively make <strong>a 2-way sync between your firestore collection or doc and your vuex module</strong>.</p> <p>Fetching the document(s) once is when you want to retrieve the document(s) once, when your application or a page is opened, but do not require to have the data to be live updated when the server data changes.</p> <p>Both with <em>realtime updates</em> and with <em>fetching docs</em> you can use <code>where</code> filters to specify which docs you want to retrieve (just like Firestore). In some modules you might initially open a channel for <em>realtime updates</em> with a certain <code>where</code> filter, and later when the user requests other docs do an additional <code>fetch</code> with another <code>where</code> filter.</p> <h2 id="realtime-updates-opendbchannel"><a href="#realtime-updates-opendbchannel" aria-hidden="true" class="header-anchor">#</a> Realtime updates: openDBChannel</h2> <p>If you want to use <em>realtime updates</em> the only thing you need to do is to dispatch the <code>openDBChannel</code> action. Eg.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'moduleName/openDBChannel'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
</code></pre></div><p><code>openDBChannel</code> is just the same as the Firestore <a href="https://firebase.google.com/docs/firestore/query-data/listen" target="_blank" rel="noopener noreferrer">onSnapshot<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> function, but the difference is that the documents from Firestore are automatically added to Vuex: in the module defined as <code>moduleName</code> and inside the object defined as <code>statePropName</code> as per your config (see <a href="/vuex-easy-firestore/setup.html#setup">setup</a>).</p> <h3 id="close-db-channel"><a href="#close-db-channel" aria-hidden="true" class="header-anchor">#</a> Close DB channel</h3> <p>In most cases you never need to close the connection to Firestore. But if you do want to close it (unsubscribe from Firestore's <code>onSnapshot</code>) you can do so like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'moduleName/closeDBChannel'</span><span class="token punctuation">)</span>
</code></pre></div><p>This will close the connection using Firestore's <a href="https://firebase.google.com/docs/firestore/query-data/listen#detach_a_listener" target="_blank" rel="noopener noreferrer">unsubscribe function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Please note that <code>closeDBChannel</code> does not mean it will not listen for &quot;local&quot; changes! This means that even with a closedDBChannel, you can continue to insert/patch/delete docs and they will still be synced to the server. However, changes on the server side will not be reflected to the app anymore.</p> <p><code>closeDBChannel</code> will not clear out the data in your current vuex module. You can also close the connection and completely clear out the module; removing all docs from your vuex module. (without deleting anything on the server, don't worry) In this case do:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'moduleName/closeDBChannel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>clearModule<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="fetching-docs"><a href="#fetching-docs" aria-hidden="true" class="header-anchor">#</a> Fetching docs</h2> <p>If you want to fetching docs once (opposed to <em>realtime updates</em>) you just need to dispatch the <code>fetchAndAdd</code> action. Eg.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetchAndAdd'</span><span class="token punctuation">)</span>
</code></pre></div><p>This is the same as doing <code>dbRef.collection(path).get()</code> with Firebase. The difference is that with <code>fetchAndAdd</code> your documents are automatically added to Vuex: in the module defined as <code>moduleName</code> and inside the object defined as <code>statePropName</code> as per your config (see <a href="/vuex-easy-firestore/setup.html#setup">setup</a>).</p> <h3 id="a-note-on-fetch-limit"><a href="#a-note-on-fetch-limit" aria-hidden="true" class="header-anchor">#</a> a note on fetch limit</h3> <p>When doing <code>fetchAndAdd</code> there will be a limit that defaults to 50 docs. If you want to fetch <em>the next 50 docs</em> you just need to call the <code>fetchAndAdd</code> action again, and it will automatically retrieve the next docs! See the example below:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// call once to fetch the first 50:</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetchAndAdd'</span><span class="token punctuation">)</span>
<span class="token comment">// then just call again to fetch the next 50!</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetchAndAdd'</span><span class="token punctuation">)</span>
<span class="token comment">// and so on...</span>
</code></pre></div><p>You can pass a custom fetch limit or disable the fetch limit by passing 0:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// custom fetch limit:</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetchAndAdd'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// no fetch limit:</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetchAndAdd'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>The <code>fetchAndAdd</code> action will return a promise resolving in <code>{done: true}</code> if there are no more docs to be fetched. You can use this to check when to stop fetching like so:</p> <div class="language-js extra-class"><pre class="language-js"><code>fetchAndAdd <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> fetchResult <span class="token operator">=</span> <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetchAndAdd'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fetchResult<span class="token punctuation">.</span>done <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'all done!'</span>
  <span class="token keyword">return</span> <span class="token string">'retrieved 50 docs, call again to fetch the next!'</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="firestore-authentication"><a href="#firestore-authentication" aria-hidden="true" class="header-anchor">#</a> Firestore authentication</h2> <p>In most cases your application will have many users, and your Firestore path will need to include the user ID of the user who is signed in. This can be done in Vuex Easy Firestore by using the <code>{userId}</code> wildcard like so:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myModule <span class="token operator">=</span> <span class="token punctuation">{</span>
  firestorePath<span class="token punctuation">:</span> <span class="token string">'userDocs/{userId}/data'</span><span class="token punctuation">,</span>
  firestoreRefType<span class="token punctuation">:</span> <span class="token string">'collection'</span><span class="token punctuation">,</span>
  moduleName<span class="token punctuation">:</span> <span class="token string">'userData'</span><span class="token punctuation">,</span>
  statePropName<span class="token punctuation">:</span> <span class="token string">'data'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Of course, you will need to wait for the user to sign in and only then dispatch either <code>openDBChannel</code> or <code>fetchAndAdd</code>. For this you can use Firebase's native <code>onAuthStateChanged</code> function:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Be sure to initialise Firebase first!</span>
Firebase<span class="token punctuation">.</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onAuthStateChanged</span><span class="token punctuation">(</span>user <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// user is logged in so openDBChannel</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'userData/openDBChannel'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
    <span class="token comment">// or fetchAndAdd</span>
    <span class="token comment">// store.dispatch('userData/fetchAndAdd')</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>If you want to use the library without fetching documents, so without using <code>openDBChannel</code> and <code>fetchAndAdd</code>, you will notice that <code>{userId}</code> is not automatically replaced with the user id. This is because <code>openDBChannel</code> and <code>fetchAndAdd</code> both dispatch an action called <code>setUserId</code> that retrieves the current user id from Firebase authentication and places it in the firestorePath.</p> <p>In this case you can manually dispatch <code>setUserId</code> like so:</p> <div class="language-js extra-class"><pre class="language-js"><code>Firebase<span class="token punctuation">.</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onAuthStateChanged</span><span class="token punctuation">(</span>user <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// in case you do not use `openDBChannel` or `fetchAndAdd`</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'userData/setUserId'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>When required you can also manually pass a user id like so: <code>dispatch('userData/setUserId', id)</code></p> <h2 id="where-orderby-filters"><a href="#where-orderby-filters" aria-hidden="true" class="header-anchor">#</a> where / orderBy filters</h2> <blockquote><p>Only for 'collection' mode.</p></blockquote> <p>Just like Firestore, you can use <code>where</code> and <code>orderBy</code> to filter which docs are retrieved and synced.</p> <ul><li><em>where:</em> arrays of &quot;parameters&quot; that get passed on to firestore's <code>.where(...parameters)</code></li> <li><em>orderBy:</em> a single &quot;array&quot; that gets passed on to firestore's <code>.orderBy(...array)</code></li></ul> <p>There are three ways to use where and orderBy. As per example we will define <code>where</code> and <code>orderBy</code> variables first, then show how you can use them:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token comment">// an array of arrays</span>
  <span class="token punctuation">[</span><span class="token string">'some_field'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'another_field'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> orderBy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'created_at'</span><span class="token punctuation">]</span> <span class="token comment">// or more params</span>
</code></pre></div><ol><li>Pass together with openDBChannel:</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/openDBChannel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>where<span class="token punctuation">,</span> orderBy<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>Pass together with fetchAndAdd:</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetchAndAdd'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>where<span class="token punctuation">,</span> orderBy<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>Define inside your vuex module, to set as default when for <code>openDBChannel</code>:</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myModule <span class="token operator">=</span> <span class="token punctuation">{</span>
  firestorePath<span class="token punctuation">:</span> <span class="token string">'myDocs'</span><span class="token punctuation">,</span>
  firestoreRefType<span class="token punctuation">:</span> <span class="token string">'collection'</span><span class="token punctuation">,</span>
  moduleName<span class="token punctuation">:</span> <span class="token string">'myModule'</span><span class="token punctuation">,</span>
  statePropName<span class="token punctuation">:</span> <span class="token string">'data'</span><span class="token punctuation">,</span>
  sync<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    where<span class="token punctuation">,</span>
    orderBy
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// Now you can do:</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/openDBChannel'</span><span class="token punctuation">)</span>
<span class="token comment">// And it will use the where and orderBy as defined in your module</span>
</code></pre></div><h3 id="a-note-on-orderby"><a href="#a-note-on-orderby" aria-hidden="true" class="header-anchor">#</a> a note on orderBy</h3> <p>Using <code>orderBy</code> works just like in Firebase: &quot;the docs will be retrieved in that order&quot;.
Please note however, that your docs are saved inside an object in your Vuex module. <strong>JavaScript object properties do not have an order.</strong> (the prop-order might differ from browser to browser)</p> <p>This means that even though you can retrieve your docs in a certain order, when showing them in a Vue component, you will need to manually sort the docs in the order you want. You can do this through a getter in your Vuex module. Eg.</p> <div class="language-js extra-class"><pre class="language-js"><code>getters<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  sortedDocs<span class="token punctuation">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> getters<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// your sort function</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="userid-in-where-orderby"><a href="#userid-in-where-orderby" aria-hidden="true" class="header-anchor">#</a> userId in where/orderBy</h3> <p>You can also use variables like <code>userId</code> (of the authenticated user) inside where filters. Eg.</p> <div class="language-js extra-class"><pre class="language-js"><code>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/openDBChannel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'created_by'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'{userId}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>{userId}</code> will be automatically replaced with the authenticated user id.</p> <p>Besides <code>userId</code> you can also use &quot;custom variables&quot;. For more information on this, see the chapter on <a href="/vuex-easy-firestore/extra-features.html#variables-for-firestorepath-or-filters">variables for firestorePath or filters</a>.</p> <h3 id="example-usage-opendbchannel-and-fetchandadd"><a href="#example-usage-opendbchannel-and-fetchandadd" aria-hidden="true" class="header-anchor">#</a> Example usage: openDBChannel and fetchAndAdd</h3> <p>Say you have an &quot;notes&quot; application that shows a user's notes when the app is opened, but only notes that are not &quot;archived&quot;. Then later when the user opens the archive-page those notes are fetched and shown as well.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// when the app is opened after user authentication:</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'userNotes/openDBChannel'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'archived'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'created_by'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'{userId}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// then when the archive-page is opened:</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'userNotes/fetchAndAdd'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'archived'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'created_by'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token string">'{userId}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Both <code>openDBChannel</code> and <code>fetchAndAdd</code> will add the documents in the same Vuex module, so it is really easy to work with. You can then create some getters with just the archived or not-archived notes like so:</p> <div class="language-js extra-class"><pre class="language-js"><code>getters<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  notArchivedNotes<span class="token punctuation">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>note <span class="token operator">=&gt;</span> <span class="token operator">!</span>note<span class="token punctuation">.</span>archived<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  archivedNotes<span class="token punctuation">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>note <span class="token operator">=&gt;</span> note<span class="token punctuation">.</span>archived<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="multiple-modules-with-2-way-sync"><a href="#multiple-modules-with-2-way-sync" aria-hidden="true" class="header-anchor">#</a> Multiple modules with 2-way sync</h2> <p>Of course you can have multiple vuex modules, all in sync with different firestore paths.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> userDataModule <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">/* config */</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> anotherModule <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">/* config */</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> aThirdModule <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">/* config */</span><span class="token punctuation">}</span>
<span class="token comment">// make sure you choose a different moduleName and firestorePath each time!</span>
<span class="token keyword">const</span> easyFirestores <span class="token operator">=</span> <span class="token function">createEasyFirestore</span><span class="token punctuation">(</span><span class="token punctuation">[</span>userDataModule<span class="token punctuation">,</span> anotherModule<span class="token punctuation">,</span> aThirdModule<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>logging<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// and include as PLUGIN in your vuex store:</span>
store<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... your store</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>easyFirestores<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Do not forget you will have to dispatch openDBChannel or fetchAndAdd for each module you want to retrieve the doc(s) of:</p> <div class="language-js extra-class"><pre class="language-js"><code>Firebase<span class="token punctuation">.</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onAuthStateChanged</span><span class="token punctuation">(</span>user <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'userDataModule/openDBChannel'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'anotherModule/openDBChannel'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'aThirdModule/openDBChannel'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="sync-directly-to-module-state"><a href="#sync-directly-to-module-state" aria-hidden="true" class="header-anchor">#</a> Sync directly to module state</h2> <p>In your vuex-easy-firestore modules you can -- instead of choosing <code>statePropName</code> where your docs will be added to -- choose to leave <code>statePropName</code> blank.</p> <p>Leaving <code>statePropName</code> blank and syncing directly to the state means that the doc(s) will be added directly to the <code>state</code> of the module.</p> <p>In most cases I would advise against this, because you might want to save other data in your module's state as well. Mixing your documents data with other data will give you a harder time when creating getters for that module!</p> <p>It is usually much better to use the same <code>statePropName</code> (eg. <code>'data'</code>) for all modules. This makes writing getters etc. much easier.</p> <h2 id="manual-fetch-handling"><a href="#manual-fetch-handling" aria-hidden="true" class="header-anchor">#</a> Manual fetch handling</h2> <p>Besides <code>fetchAndAdd</code> there is also the <code>fetch</code> action. The difference is that with just <code>fetch</code>  it will not add the documents to your vuex module, so you can handle the result yourself. <code>fetch</code> is useful because it will automatically use the Firestore path from your module.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetch'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>where<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'archived'</span><span class="token punctuation">,</span> <span class="token string">'=='</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>querySnapshot <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>querySnapshot<span class="token punctuation">.</span>done <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// `{done: true}` is returned when everything is already fetched and there are 0 docs:</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished fetching all docs'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// do whatever you want with the `querySnapshot`</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
</code></pre></div><p>The <code>querySnapshot</code> that is returned is the same querySnapshot as the Firestore one. Please read the <a href="https://firebase.google.com/docs/reference/js/firebase.firestore.QuerySnapshot" target="_blank" rel="noopener noreferrer">Firestore documentation on querySnapshot<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to know what you can do with these. Only when all documents were already fetched (and the result is 0 docs) vuex-easy-firestore will return <code>{done: true}</code> instead.</p> <p>Please note, just like <a href="#fetching-docs">fetchAndAdd</a> explained above, <code>fetch</code> also has a default limit of 50 docs per retrieval. You can then continue calling fetch to retrieve the next set of docs or pass a custom limit or 0 to disable it.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// custom fetch limit:</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetch'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// no fetch limit:</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'myModule/fetch'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>limit<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/mesqueeb/vuex-easy-firestore/edit/dev/docs/query-data.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vuex-easy-firestore/add-and-manage-data.html" class="prev">
          Add and manage data
        </a></span> <span class="next"><a href="/vuex-easy-firestore/firestore-fields-and-functions.html">
          Firestore fields and functions
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/vuex-easy-firestore/assets/js/10.5094f20e.js" defer></script><script src="/vuex-easy-firestore/assets/js/app.b09044e6.js" defer></script>
  </body>
</html>
